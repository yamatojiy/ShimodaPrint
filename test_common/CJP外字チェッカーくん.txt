*■*****************************************************************************
*■*****************　　　　　  表の指定項目に外字があるかチェックする。
*■*****************　　　　１.全部見る。
*■*****************　　　　２.あればテキストで吐き出す
*■*****************　　　　３.終わりを告げる
*■*****************************************************************************
var 数値  { &検索結果　, &検索住所1 , &検索住所2 , &CHK , &gaiCount = 0 }
var 文字列{ &出力日 , &ログ名称 }

    &出力日 = #日時文字列 (#日時値 , 1 , 3 , 3 ） 
    &ログ名称 = "外字確認出力ログ" + &出力日

    印字開始　&ログ名称 　,　終了状態　= &CHK
    
    繰り返し（ .NOT #終端行 ）

        /*▼各項目に外字が入ってるか確認する　*/
        &検索結果 = #IS外字( [氏名・組合名] , 0 )
        &検索住所1 = #IS外字( [住所1] , 0 )
        &検索住所2 = #IS外字( [住所2] , 0 )

        /*▼場合によって、ログ情報を変える　*/
        
        if (&検索結果 <>0)
        印字 "名前：",_9, #文字列(  &検索結果 )+"番目に外字が入ってます！" ,_9, [氏名・組合名] ,　_9 ,　[よみ] ,　_9 , [住所1] , _9 , [住所2]
        end
        if (&検索住所1 <>0)
        印字 "住所1：",_9, #文字列(  &検索住所1 )+"番目に外字が入ってます！" ,_9, [氏名・組合名] ,　_9 ,　[よみ] ,　　_9  , [住所1] ,　_9 ,  [住所2]
        end
        if (&検索住所2 <>0)
        印字  "住所２：",_9,  #文字列(  &検索住所2 )+"番目に外字が入ってます！" ,_9, [氏名・組合名] ,　_9 ,　[よみ] ,　_9 , [住所1] ,　_9 ,  [住所2]
        end

        /*▼どれかフラグが立ってれば、件数にカウントを足す　*/
        if (&検索結果 <>0 .or &検索住所1 <>0 .or &検索住所2 <>0 )
            &gaiCount = &gaiCount + 1    
        end

    ジャンプ 行番号 = 次行 
    繰り返し終了 
    印字終了

    /*▼外字があるかで最後の出力を変える　*/
    if (&gaiCount <> 0 )

        var 文字列{ &MSG }

        &MSG = #文字列( &gaiCount )+"件の外字データが入っていました。 ログをテキストに出力しました" 
        確認　&MSG　
    else

        var 文字列{ &MSG }
        ファイル削除　&ログ名称 +".txt" , 終了状態 = &CHK
        &MSG = "問題ございませーん！"
        確認　&MSG
    end

    ジャンプ 行番号 = 1